<html>

<head>
    <meta http-equiv="Content-Type" contentDiv="text/html; charset=utf-8" />
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"></link>
    <style>
        #__controls {
            position: fixed;
            top: 0px;
            left: 0px;
            width: calc(100% - 80px);
            height: 75px;
            padding: 0px 40px;
            background-color: #333333;
            color: #BBBBBB;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 13pt;
        }

        #__controls .controls-left {
            float: left;
            text-align: left;
        }

        #__controls .controls-right {
            float: right;
            text-align: right;
        }

        #__controls a:link,
        #__controls a:visited {
            color: #FAFAFA;
            text-decoration: none;
        }

        #__controls a:active,
        #__controls a:hover {
            color: #FF6666;
            text-decoration: none;
        }

        #__historyContainer {
            position: fixed;
            top: 75px;
            left: 0px;
            height: 400px;
            width: 100%;
            overflow: auto;
            background-color: #333333;
        }

        #__history * {
            max-width: 750px !important;
            margin-left: auto !important;
            margin-right: auto !important;
            color: #777777 !important;
            font-family: Arial, Helvetica, sans-serif !important;
            font-size: 13pt !important;
        }

        #__history .__inlineMacro {
            animation: none;
            color: #777777;
        }

        .__disabledLink {
            color: #777777;
            text-decoration: underline;
        }

        #__content {
            position: absolute;
            top: 75px;
            left: 0px;
            width: 100%;
            overflow: auto;
        }

        #__currentSection {
            color: #555555;
            animation: 1s textFadeIn;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        @keyframes textFadeIn {
            from {
                color: #FAFAFA;
            }
            to {
                color: #555555;
            }
        }

        .__inlineMacro {
            animation: 1s inlineMacroFadeIn;
            color: #a7826a;
        }

        @keyframes inlineMacroFadeIn {
            from {
                color: #FAFAFA;
            }
            to {
                color: #a7826a;
            }
        }

        h1 {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 56pt;
            margin-top: 28pt;
            margin-bottom: -4pt;
            line-height: 0.9em;
        }

        h2 {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 38pt;
            margin-top: 19pt;
            margin-bottom: -12pt;
        }

        h3 {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 22pt;
            text-transform: uppercase;
            margin-top: 11pt;
            margin-bottom: -8pt;
        }

        body {
            background-color: #FAFAFA;
        }

        p {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 16pt;
            line-height: 1.5em;
        }

        a:link,
        a:visited {
            color: #6666FF;
        }

        a:active,
        a:hover {
            color: #FF6666;
        }

        li {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 16pt;
            line-height: 1.5em;
            margin-left: 20px;
        }

        blockquote p {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 16pt;
            font-style: italic;
            line-height: 1.5em;
        }

        pre {
            font-family: "Courier New", "Courier", monospace;
            font-size: 14pt;
            background-color: #333333;
            color: #BBBBBB;
            line-height: 1.5em;
            padding: 10px 20px;
            max-height: 600px;
            overflow: auto;
        }

        img {
            margin: 20px 0px;
        }

        hr {
            border: 0;
            height: 1px;
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
            margin-top: 36pt;
            margin-bottom: 36pt;
        }
    </style>
    <script type="text/javascript" src="phaser.js"></script>
    <script>
        var exports = {};
        "use strict";
        Object.defineProperty(exports, "__esModule", {
            value: true
        });
        var Core;
        (function(Core) {
            Core.OnGotoSection = [];

            function AddEventListener(eventName, handler) {
                switch (eventName) {
                    case "OnGotoSection":
                        {
                            Core.OnGotoSection = Core.OnGotoSection.concat(handler);
                            break;
                        }
                    default:
                        {
                            console.error("Core.AddEventListener: \"" + eventName + "\" is not a valid event");
                            break;
                        }
                }
            }
            Core.AddEventListener = AddEventListener;

            function DisableLinks(section) {
                var links = section.getElementsByTagName("a");
                for (var i = 0; i < links.length; i++) {
                    var linkTag = links[i].outerHTML.substring(0, links[i].outerHTML.indexOf(">") + 1);
                    var contents = links[i].outerHTML.substring(links[i].outerHTML.indexOf(">") + 1, links[i].outerHTML.indexOf("</a>"));
                    links[i].outerHTML = "<span class=\"__disabledLink\" data-link-tag='" + linkTag + "'>" + linkTag + contents + "</span>";
                }
            }

            function EnableInlineMacros(root, tf) {
                if (tf === void 0) {
                    tf = true;
                }
                if (tf && root.id.search("_inline\-") > -1) {
                    root.id = root.id.substring(1);
                } else if (!tf && root.id.search("inline\-") > -1) {
                    root.id = "_" + root.id;
                }
                for (var i = 0; i < root.children.length; i++) {
                    EnableInlineMacros(root.children[i], tf);
                }
            }

            function EnableLinks(section) {
                var links = section.getElementsByClassName("__disabledLink");
                for (var i = 0; i < links.length;) {
                    var linkTag = links[i].getAttribute('data-link-tag');
                    var contents = links[i].innerHTML;
                    links[i].outerHTML = linkTag + contents + '</a>';
                }
            }

            function ExpandMacro(macro) {
                switch (macro[0]) {
                    case '@':
                        {
                            var sectionName = macro.substring(1);
                            if (!document.getElementById(sectionName)) {
                                return "{section \"" + sectionName + "\" is not declared}";
                            } else {
                                return ExpandSection(macro.substring(1)).innerHTML;
                            }
                        }
                    case '#':
                        {
                            var targetFunction = RetrieveFromWindow(macro.substring(1), 'function');
                            return targetFunction().toString();
                        }
                    case '$':
                        {
                            var targetVariable = RetrieveFromWindow(macro.substring(1), 'variable');
                            return targetVariable.toString();
                        }
                    default:
                        {
                            return "{unknown metacharacter in macro \"" + macro + "\"";
                        }
                }
            }
            Core.ExpandMacro = ExpandMacro;

            function ExpandSection(id) {
                var source = document.getElementById(id);
                if (source === null) {
                    console.log("Section " + id + " doesn't exist");
                    return null;
                }
                var sectionInstance = source.cloneNode(true);
                sectionInstance.removeAttribute("hidden");
                var scan = function(element) {
                    for (var i = 0; i < element.attributes.length; i++) {
                        var expanded = false;
                        switch (element.attributes[i].name) {
                            case "data-expand-macro":
                                {
                                    if (element.parentElement) {
                                        var newElement = document.createElement("span");
                                        newElement.innerHTML = ExpandMacro(element.attributes[i].value);
                                        element.parentElement.replaceChild(newElement, element);
                                        expanded = true;
                                    }
                                    break;
                                }
                            case "data-image-source-macro":
                                {
                                    var source_1 = ExpandMacro(element.attributes[i].value);
                                    console.log("Expanding " + element.tagName + " with src attribute " + element.attributes[i].value + " to \"" + source_1 + "\"");
                                    element.setAttribute("src", ExpandMacro(element.attributes[i].value));
                                    expanded = true;
                                }
                        }
                        if (expanded) {
                            break;
                        }
                    }
                    if (element.hasChildNodes) {
                        for (var i = 0; i < element.children.length; i++) {
                            scan(element.children[i]);
                        }
                    }
                };
                scan(sectionInstance);
                return sectionInstance;
            }

            function GotoPreviousSection() {
                var history = document.getElementById("__history");
                var currentSection = document.getElementById("__currentSection");
                var previousSections = history.getElementsByClassName('__previousSection');
                var previousSection = previousSections[previousSections.length - 1];
                if (!previousSection) {
                    return;
                }
                var id = previousSection.getAttribute('data-id');
                var clone = previousSection.cloneNode(true);
                history.removeChild(previousSection);
                EnableLinks(clone);
                RegisterLinks(clone);
                clone.scrollTop = 0;
                clone.id = "__currentSection";
                currentSection.parentElement.replaceChild(clone, currentSection);
                for (var i = 0; i < Core.OnGotoSection.length; i++) {
                    Core.OnGotoSection[i](id, clone, [], true);
                }
            }
            Core.GotoPreviousSection = GotoPreviousSection;

            function GotoSection(id) {
                var history = document.getElementById("__history");
                var currentSection = document.getElementById("__currentSection");
                DisableLinks(currentSection);
                var previousSectionId = currentSection.getAttribute('data-id');
                if (previousSectionId !== null) {
                    history.innerHTML += "<div class=\"__previousSection\" data-id=\"" + previousSectionId + "\">" + currentSection.innerHTML + "</div>";
                    history.scrollTop = history.scrollHeight;
                }
                var clone = ExpandSection(id);
                clone.setAttribute('data-id', id);
                EnableInlineMacros(clone, true);
                RegisterLinks(clone);
                clone.scrollTop = 0;
                clone.id = "__currentSection";
                currentSection.parentElement.replaceChild(clone, currentSection);
                for (var i = 0; i < Core.OnGotoSection.length; i++) {
                    Core.OnGotoSection[i](id, clone, [], false);
                }
            }
            Core.GotoSection = GotoSection;

            function RegisterLinks(element) {
                if (element.tagName == "A") {
                    var _loop_1 = function(i) {
                        switch (element.attributes[i].name) {
                            case "data-goto-section":
                                {
                                    element.addEventListener("click", function() {
                                        Core.GotoSection(element.attributes[i].value);
                                    });
                                    break;
                                }
                            case "data-call-function":
                                {
                                    element.addEventListener("click", RetrieveFromWindow(element.attributes[i].value, 'function'));
                                    break;
                                }
                            case "data-replace-with":
                                {
                                    element.addEventListener("click", function() {
                                        Core.ReplaceActiveElement(element.id, ExpandMacro(element.attributes[i].value));
                                    });
                                    break;
                                }
                        }
                    };
                    for (var i = 0; i < element.attributes.length; i++) {
                        _loop_1(i);
                    }
                }
                if (element.hasChildNodes) {
                    for (var i = 0; i < element.children.length; i++) {
                        RegisterLinks(element.children[i]);
                    }
                }
            }
            Core.RegisterLinks = RegisterLinks;

            function RetrieveFromWindow(name, type) {
                var targetObject = null;
                var tokens = name.split('.');
                for (var i = 0; i < tokens.length; i++) {
                    if (i === 0) {
                        targetObject = window[tokens[0]];
                    } else {
                        targetObject = targetObject[tokens[i]];
                    }
                }
                if (targetObject === undefined) {
                    return "{" + type + " \"" + name + "\" is not declared}";
                }
                return targetObject;
            }

            function ReplaceActiveElement(id, html) {
                for (var element = document.getElementById(id); element; element = document.getElementById(id)) {
                    if (!element) {
                        continue;
                    }
                    var bIsActive = false;
                    for (var parent_1 = element.parentElement; parent_1; parent_1 = parent_1.parentElement) {
                        if (parent_1.id === "__currentSection") {
                            bIsActive = true;
                            break;
                        }
                    }
                    if (bIsActive) {
                        var replacement = document.createElement("span");
                        replacement.className = "__inlineMacro";
                        replacement.innerHTML = html;
                        EnableInlineMacros(replacement, true);
                        RegisterLinks(replacement);
                        element.parentNode.replaceChild(replacement, element);
                        break;
                    }
                }
            }
            Core.ReplaceActiveElement = ReplaceActiveElement;

            function ShowHistory(tf) {
                var history = document.getElementById("__history");
                history.hidden = !tf;
            }
            Core.ShowHistory = ShowHistory;
        })(Core = exports.Core || (exports.Core = {}));
        //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29yZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9Db3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBc0JBLElBQWlCLElBQUksQ0FnWXBCO0FBaFlELFdBQWlCLElBQUk7SUFTVCxrQkFBYSxHQUE2RixFQUFFLENBQUM7SUFPeEgsMEJBQWlDLFNBQWtCLEVBQUUsT0FBb0I7UUFFeEUsTUFBTSxDQUFBLENBQUMsU0FBUyxDQUFDLENBQ2pCLENBQUM7WUFDQSxLQUFLLGVBQWU7Z0JBQ3BCLENBQUM7b0JBQ0EsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztvQkFDeEQsS0FBSyxDQUFDO2dCQUNQLENBQUM7WUFDRDtnQkFDQSxDQUFDO29CQUNBLE9BQU8sQ0FBQyxLQUFLLENBQUMsOEJBQTJCLFNBQVMsNEJBQXdCLENBQUMsQ0FBQztvQkFDNUUsS0FBSyxDQUFDO2dCQUNQLENBQUM7UUFDRixDQUFDO0lBQ0YsQ0FBQztJQWZlLHFCQUFnQixtQkFlL0IsQ0FBQTtJQUtELHNCQUFzQixPQUFpQjtRQUV0QyxJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsb0JBQW9CLENBQUMsR0FBRyxDQUFDLENBQUM7UUFJOUMsR0FBRyxDQUFBLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUNwQyxDQUFDO1lBR0EsSUFBSSxPQUFPLEdBQVksS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBRzVGLElBQUksUUFBUSxHQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUNuRCxL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 source/script.js
        Core.AddEventListener("OnGotoSection", function(id, element, tags, isGoingBack) {
            alert(`Transitioned to section "${id}" with tags "${tags}"`);
        });
    </script>
    <script>
        function __Restart() {
            location.reload();
        }

        function __ToggleHistory() {
            var historyContainerDiv = document.getElementById("__historyContainer");
            if (!historyContainerDiv) {
                return;
            }

            var historyDiv = document.getElementById("__history");
            if (!historyDiv) {
                return;
            }

            var contentDiv = document.getElementById("__content");
            if (!contentDiv) {
                return;
            }

            // Toggle history visibility
            historyContainerDiv.hidden = !historyContainerDiv.hidden;
            historyDiv.hidden = historyContainerDiv.hidden;

            // Scroll to bottom of history
            historyContainerDiv.scrollTop = historyContainerDiv.scrollHeight;

            // Adjust content position relative to history panel
            var contentTop = 75 + (historyContainerDiv.hidden ? 0 : 425);
            contentDiv.style.setProperty("top", contentTop);
            contentDiv.style.setProperty("height", window.innerHeight - contentTop);
        }
        Core.AddEventListener("OnGotoSection", function(id, element, tags) {
            // Scroll to bottom of history
            var historyContainerDiv = document.getElementById("__historyContainer");
            if (historyContainerDiv) {
                historyContainerDiv.scrollTop = historyContainerDiv.scrollHeight;
            }

            // Scroll to top of new content
            var contentDiv = document.getElementById("__content");
            if (contentDiv) {
                contentDiv.scrollTop = 0;
            }
        });
    </script>
</head>

<body>
    <div id="__phaser"></div>
    <div id="__content">
        <!-- source/text.md -->
        <div id="Start" class="section" hidden="true">
            <p>This example tests script callbacks which can be assigned in user scripts, such as <code>Core.OnGotoSection</code> which is called whenever the current section changes. Try it out by <a title="" href="#" data-goto-section="SectionOne">clicking here</a>.</p>
        </div>
        <div id="SectionOne" class="section" hidden="true">
            <p>This is another section!</p>
            <p><a title="" href="#" data-goto-section="Start">Back to start</a></p>
        </div>

        <div id="__currentSection"></div>
    </div>
    <div id="__historyContainer" hidden>
        <div id="__history"></div>
    </div>
    <div id="__controls">
        <p class="controls-left">
            <a href="javascript:Core.GotoPreviousSection();">Back</a>
        </p>
        <p class="controls-right">
            <a href="#" onclick="__Restart()">Restart</a> -
            <a href="#" onclick="__ToggleHistory()">Toggle History</a>
        </p>
    </div>
</body>

</html>
<script type="text/javascript">
    window.onload = function() {
        var args = {
            "width": 480,
            "height": 800,
            "transparent": false,
            "antialias": true
        }; // This code is injected into a Fractive story's output HTML file as the first
        // sequence of JavaScript that will be executed.
        // args.width, .height, .transparent, and .antialias will be set before
        // this code is invoked.

        // Helper creates a function that wraps another function in a null-check
        function checkAndCall(functionName) {
            return function() {
                if (window[functionName] !== undefined) {
                    window[functionName]();
                } else {
                    console.log("Function " + functionName + " is not defined. Skipping it.");
                }
            };
        }

        // Create a Phaser game object.
        var phaser = new Phaser.Game(args.width, args.height, Phaser.AUTO, '__phaser', {
            preload: checkAndCall('__preload'),
            create: checkAndCall('__create'),
            update: checkAndCall('__update'),
            render: checkAndCall('__render')
        }, args.transparent, args.antialias);

        // Auto-start at the story section called "Start"
        Core.GotoSection("Start");
    };
</script>